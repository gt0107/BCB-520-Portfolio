---
title: "BCB 520 - Midterm Portfolio Post"
subtitle: "In Progress"
author: "Geraline Trossi-Torres"
date: "2024-03-16"
categories: [Midterm, DataViz, Visualization]
image: Profile4.jpg
code-fold: true
code-tools: true
description: "In Progress"
---


## THE DATA - UNIVERSITY OF IDAHO

Write a summary of the data sources you have used. Include a Data Dictionary table that fully describes each individual data source used. You may supplement the data supplied to you with additional sources if you like, but this is not required.


### Department of Agriculture (NIFA)

```{r, message=FALSE}
suppressPackageStartupMessages(library(readxl))
suppressPackageStartupMessages(library(dplyr))
suppressPackageStartupMessages(library(tidyverse))
```

```{r}
library(tidyverse)
library(readxl)
library(knitr)

USDAUI  <- read.csv("USDAtoUI.csv")
knitr::kable(head(USDAUI))
```

```{r}
library(dplyr)

# Assuming 'Date' is the column containing the grant date information
start_date <- as.Date("2021-01-01")
end_date <- as.Date("2024-03-15")

UIgrants_recent_grantsUSDA <- USDAUI %>% 
  filter(Award.Date >= start_date & Award.Date <= end_date) %>%
  arrange(desc(Award.Date))
```

```{r}
library(dplyr)

start_date <- as.Date("2024-01-01")
end_date <- as.Date("2024-12-31")

UIgrants_2024_grantsUSDA <- UIgrants_recent_grantsUSDA %>% 
  filter(Award.Date >= start_date & Award.Date <= end_date) %>%
  summarise(UIgrants_2024_grantsUSDA = n())
```
### Department of Energy (DOE)

```{r, message=FALSE}
suppressPackageStartupMessages(library(readxl))
suppressPackageStartupMessages(library(dplyr))
suppressPackageStartupMessages(library(tidyverse))
```

```{r, message=FALSE, warning=FALSE}
library(readxl)
DOEawardsUI <- read_xlsx("DOEawards.xlsx", .name_repair = "minimal")
```

```{r}
library(readxl)
library(dplyr)

DOEawardsUI <- read_xlsx("DOEawards.xlsx")

DOEUI_General <- DOEawardsUI %>% 
  dplyr::filter(Institution == 'Regents of the University of Idaho')

DOEUI_New_Awards <- DOEUI_General %>%
  select(Title, Institution, PI, Status, `Action Type`, `Program Office`, `Start Date`, `End Date`, `Most Recent Award Date`, `Amount Awarded to Date`)

knitr::kable(head(DOEUI_New_Awards))
library(tidyverse)

library(readr)
DOEawardsUI <- suppressMessages(read_xlsx("DOEawards.xlsx"))
```


### National Institutes of Health (NIH)

```{R}
library(readxl)
library(dplyr)
library(tidyverse)

NIHUIAwardsActive <- read_xlsx("NIHUI_2.xlsx")

NIHUI_New_Awards_Specific <- NIHUIAwardsActive %>%
  select('Project Title', 'Administering IC', 'Award Notice Date', `Opportunity Number`, `Project Number`, `Project Start Date`, `Project End Date`, `Budget Start Date`, `Budget End Date`, 'Total Cost', 'Total Cost (Sub Projects)', 'Funding IC(s)', 'Direct Cost IC', 'InDirect Cost IC', 'Total Cost IC')

knitr::kable(head(NIHUI_New_Awards_Specific))

```


### National Science Foundation (NSF)

```{R}
library(readxl)
library(dplyr)
library(tidyverse)
library(knitr) # Ensure knitr is explicitly loaded for kable()

# Reading the dataset from an Excel file
NSFUIAwardsActive <- read_xlsx("NSFUI_2.xlsx")

# Selecting specific columns, ensure there are no leading or trailing spaces in column names
NSFUI_New_Awards_Specific <- NSFUIAwardsActive %>%
  select(Title, NSFOrganization, StartDate, LastAmendmentDate, EndDate, AwardedAmountToDate)

# Displaying the first few rows in a table format
knitr::kable(head(NSFUI_New_Awards_Specific))

```


## QUESTION 1

Provide a visualization that shows our active awards from each sponsor. I need to see their start date and end date, the amount of the award, and the name of the Principal Investigator. I’m really interested in seeing how far into the future our current portfolio will exist. Are there a bunch of awards about to expire? Are there a bunch that just got funded and will be active for a while? Does this vary across sponsors?

## QUESTION 2

What is the proportional representation of new awards to the UI from these various sources over the past 5 to 10 years? Are there any trends that are encouraging or discouraging?


## QUESTION 3

How is UI performing with these sponsors when compared to the following peer institutions?

### Boise State University

**Department of Agriculture (NIFA)**

```{r}
library(tidyverse)
library(readxl)
library(knitr)

BSUUSDA  <- read.csv("USDABSU.csv")
knitr::kable(head(BSUUSDA))
```

**Department of Energy**
```{r}
library(readxl)
library(dplyr)

DOEawardsBSU <- read_xlsx("DOEawards.xlsx")

DOEBSU_General <- DOEawardsBSU %>% 
  dplyr::filter(Institution == 'Boise State University')

DOEBSU_New_Awards <- DOEBSU_General %>%
  select(Title, Institution, PI, Status, `Action Type`, `Program Office`, `Start Date`, `End Date`, `Most Recent Award Date`, `Amount Awarded to Date`)

knitr::kable(head(DOEBSU_New_Awards))
library(tidyverse)
```

**National Institutes of Health (NIH)**

```{R}
library(readxl)
library(dplyr)
library(tidyverse)

NIHBSUAwardsActive <- read_xlsx("NIHBSU_2.xlsx")

NIHBSU_New_Awards_Specific <- NIHBSUAwardsActive %>%
  select('Project Title', 'Administering IC', 'Award Notice Date', `Opportunity Number`, `Project Number`, `Project Start Date`, `Project End Date`, `Budget Start Date`, `Budget End Date`, 'Total Cost', 'Total Cost (Sub Projects)', 'Funding IC(s)', 'Direct Cost IC', 'InDirect Cost IC', 'Total Cost IC')

knitr::kable(head(NIHBSU_New_Awards_Specific))

```

**National Science Foundation (NSF)**

```{R}
library(readxl)
library(dplyr)
library(tidyverse)
library(knitr) # Ensure knitr is explicitly loaded for kable()

# Reading the dataset from an Excel file
NSFBSUAwardsActive <- read_xlsx("NSFBSU_2.xlsx")

# Selecting specific columns, ensure there are no leading or trailing spaces in column names
NSFBSU_New_Awards_Specific <- NSFBSUAwardsActive %>%
  select(Title, NSFOrganization, StartDate, LastAmendmentDate, EndDate, AwardedAmountToDate)

# Displaying the first few rows in a table format
knitr::kable(head(NSFBSU_New_Awards_Specific))

```

### Idaho State University

**Department of Energy**
```{r}
library(readxl)
library(dplyr)

DOEaward <- read_xlsx("DOEawards.xlsx")

DOEIDAHOSATTE_General <- DOEaward %>% 
  dplyr::filter(Institution == 'Idaho State University')

DOEDAHOSATTE_New_Awards <- DOEIDAHOSATTE_General %>%
  select(Title, Institution, PI, Status, `Action Type`, `Program Office`, `Start Date`, `End Date`, `Most Recent Award Date`, `Amount Awarded to Date`)

knitr::kable(head(DOEDAHOSATTE_New_Awards))
library(tidyverse)
```

**Department of Agriculture (NIFA)**

```{r}
library(tidyverse)
library(readxl)
library(knitr)

ISUUSDA  <- read.csv("USDAISU.csv")
knitr::kable(head(ISUUSDA))
```

**National Institutes of Health (NIH)**

```{R}
library(readxl)
library(dplyr)
library(tidyverse)

NIHISUAwardsActive <- read_xlsx("NIHISU_2.xlsx")

NIHISU_New_Awards_Specific <- NIHISUAwardsActive %>%
  select('Project Title', 'Administering IC', 'Award Notice Date', `Opportunity Number`, `Project Number`, `Project Start Date`, `Project End Date`, `Budget Start Date`, `Budget End Date`, 'Total Cost', 'Total Cost (Sub Projects)', 'Funding IC(s)', 'Direct Cost IC', 'InDirect Cost IC', 'Total Cost IC')

knitr::kable(head(NIHISU_New_Awards_Specific))

```

**National Science Foundation (NSF)**

```{R}
library(readxl)
library(dplyr)
library(tidyverse)
library(knitr) # Ensure knitr is explicitly loaded for kable()

# Reading the dataset from an Excel file
NSFISUAwardsActive <- read_xlsx("NSFISU_2.xlsx")

# Selecting specific columns, ensure there are no leading or trailing spaces in column names
NSFISU_New_Awards_Specific <- NSFISUAwardsActive %>%
  select(Title, NSFOrganization, StartDate, LastAmendmentDate, EndDate, AwardedAmountToDate)

# Displaying the first few rows in a table format
knitr::kable(head(NSFISU_New_Awards_Specific))

```

Note that “performing” can mean a variety of different things. You must choose your metrics of performance and justify them.



```{R}
# COMPARISON BETWEEEN USDA - AWARD MONEY

library(readxl)

USDA_Compare_Data <- read_xlsx("USDA_Combined_Data_Recent_Awards.xlsx")

library(dplyr)
library(ggplot2)

library(dplyr)

# Calculate total award money for each institution
USDA_total_award_money <- USDA_Compare_Data %>%
  group_by(Grantee_Name) %>%
  summarise(USDA_total_award_money = sum(Award_Dollars))

library(ggplot2)

ggplot(USDA_total_award_money, aes(x = Grantee_Name, y = USDA_total_award_money)) +
  geom_bar(stat = "identity", fill = "blue") +
  ggtitle("Total of Award Money from USDA Grants") +
  xlab("") +
  ylab("Total Award Money") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1),
        axis.text.y = element_text(size = 12),
        plot.title = element_text(hjust = 0.5)) +  # Corrected position of plot title
  scale_y_continuous(labels = scales::number_format(scale = 1e-6, suffix = "M"))

```

## CONLUSIONS/SUMMARY
