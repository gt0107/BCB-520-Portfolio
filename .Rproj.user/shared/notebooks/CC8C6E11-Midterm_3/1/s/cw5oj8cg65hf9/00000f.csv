"0","# COMPARISON BETWEEEN NSF - Grant Status"
"0","library(dplyr)"
"0","library(ggplot2)"
"0",""
"0","# Calculate total grant action count for each institution"
"0","NSF_Grant_Award_Instrument <- NSF_Compare_Data %>%"
"0","  group_by(Organization, AwardInstrument) %>%"
"0","  summarise(count = n(), .groups = ""drop"") %>%"
"0","  ungroup()"
"0",""
"0","# Check unique levels of AwardInstrument"
"0","unique_levels <- unique(NSF_Grant_Award_Instrument$AwardInstrument)"
"0",""
"0","# Adjust my_colors_4 to match the number of unique levels"
"0","my_colors_4 <- c(""navyblue"", ""darkgreen"", ""darkorange"", ""darkred"")  # or any other color palette you prefer"
"0",""
"0","# Plot with adjusted colors"
"0","ggplot(NSF_Grant_Award_Instrument, aes(x = Organization, y = count, fill = AwardInstrument)) +"
"0","  geom_bar(stat = ""identity"", position = ""dodge"") +"
"0","  ggtitle(""Number of Counts of Action Type by Institution"") +"
"0","  xlab("""") +"
"0","  ylab(""Number of Active Grants"") +"
"0","  scale_fill_manual(values = my_colors_4) +  # Add this line to set custom colors"
"0","  theme_minimal() +"
"0","  theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 12),  "
"0","        axis.text.y = element_text(size = 12),  "
"0","        legend.text = element_text(size = 12),  "
"0","        plot.title = element_text(hjust = 0.5, size = 14))"
