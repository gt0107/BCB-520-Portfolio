"0","# Convert Amount to numeric"
"0","Q1_Data$Amount <- as.numeric(Q1_Data$Amount)"
"0",""
"0","# Define colors for each sponsor"
"0","sponsor_colors <- c(""DOE"" = ""darkgray"", ""NSF"" = ""gold"", ""NIH"" = ""black"")"
"0",""
"0","# Create the bar plot with PI on the x-axis and filled bars by Sponsor"
"0","ggplot(Q1_Data, aes(x = PI, y = Amount, fill = Sponsor)) +"
"0","  geom_bar(stat = ""summary"", fun = ""sum"") +"
"0","  labs(title = ""Total Amount by PI and Sponsor"","
"0","       x = ""Principal Investigator"","
"0","       y = ""Total Amount (Millions)"") +"
"0","  scale_y_continuous(labels = scales::unit_format(unit = ""M"")) +"
"0","  theme_minimal() +"
"0","  theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 8),  # Adjust font size"
"0","        plot.title = element_text(hjust = 0.5)) +  # Adjust title alignment"
"0","  scale_fill_manual(values = sponsor_colors)  # Use manually defined colors for each sponsor"
