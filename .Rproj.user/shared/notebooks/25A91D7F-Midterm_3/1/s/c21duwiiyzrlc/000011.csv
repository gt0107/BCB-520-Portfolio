"0","library(ggplot2)"
"0","library(scales)  # For formatting labels"
"0",""
"0","# Read the data"
"0","Q1_Data_Amount <- read_xlsx(""Q1_Compilled_Data_4.xlsx"")"
"0",""
"0","# Convert Amount to numeric"
"0","Q1_Data_Amount$Amount <- as.numeric(Q1_Data_Amount$Amount)"
"2","Warning: NAs introduced by coercion"
"0","# Check if there are any non-numeric values in Amount"
"0","non_numeric <- Q1_Data_Amount[!is.na(as.numeric(Q1_Data_Amount$Amount)), ]"
"0",""
"0","# Check the structure of the Amount variable"
"0","str(Q1_Data_Amount$Amount)"
"1"," num [1:126] "
"1",""
"1","0 266181 848625 0 0"
"1",""
"1"," ..."
"1",""
"1","
"
"0","# Define colors for each sponsor"
"0","sponsor_colors <- c(""DOE"" = ""darkgray"", ""NSF"" = ""gold"", ""NIH"" = ""black"", ""USDA"" = ""lightgray"")"
"0",""
"0","# Create the bar plot with colors assigned to each sponsor"
"0","ggplot(Q1_Data_Amount, aes(x = Sponsor, y = Amount, fill = Sponsor)) +"
"0","  geom_bar(stat = ""summary"", fun = ""sum"") +"
"0","  labs(title = ""Total Amount by Sponsor"","
"0","       x = ""Sponsor"","
"0","       y = ""Total Amount (Millions)"") +"
"0","  scale_y_continuous(labels = scales::unit_format(unit = ""M"")) +"
"0","  theme_minimal() +"
"0","  theme(axis.text.x = element_text(angle = 45, hjust = 1),"
"0","        plot.title = element_text(hjust = 0.5)) +  # Adjust title alignment"
"0","  scale_fill_manual(values = sponsor_colors)  # Use manually defined colors for each sponsor"
