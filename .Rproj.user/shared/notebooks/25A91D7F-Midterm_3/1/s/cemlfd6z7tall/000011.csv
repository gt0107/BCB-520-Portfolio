"0","library(ggplot2)"
"0","library(readxl)"
"0","library(dplyr)"
"0","library(lubridate)"
"0",""
"0","# Read the data"
"0","Q1_Data_PI <- read_xlsx(""Q1_Compilled_Data.xlsx"")"
"0",""
"0","# Filter the data for DOE sponsor"
"0","Q1_PI_NSF <- Q1_Data_PI %>%"
"0","  filter(Sponsor == ""NSF"")"
"0",""
"0","# Convert StartDate and EndDate to Date objects"
"0","Q1_PI_NSF$StartDate <- as.Date(Q1_PI_NSF$StartDate, format = ""%m/%d/%Y"")"
"0","Q1_PI_NSF$EndDate <- as.Date(Q1_PI_NSF$EndDate, format = ""%m/%d/%Y"")"
"0",""
"0","# Filter out rows with NA values in StartDate or EndDate"
"0","Q1_PI_NSF <- Q1_PI_NSF[complete.cases(Q1_PI_NSF$StartDate, Q1_PI_NSF$EndDate), ]"
"0",""
"0","# Determine the minimum and maximum dates for the x-axis"
"0","min_date <- min(Q1_PI_NSF$StartDate)"
"0","max_date <- max(Q1_PI_NSF$EndDate)"
"0",""
"0","# Extend the x-axis by a certain margin (e.g., 1 year)"
"0","extended_min_date <- min_date - lubridate::years(1)"
"0","extended_max_date <- max_date + lubridate::years(1)"
"0",""
"0","# Create the Gantt chart with adjusted y-axis labels and amounts"
"0","ggplot(Q1_PI_NSF, aes(y = PI, x = StartDate, xend = EndDate)) +"
"0","  geom_segment(aes(xend = EndDate, y = PI, yend = PI), size = 5, color = ""gold"") +  # Segment colored by PI"
"0","  geom_text(aes(x = EndDate, label = Amount), vjust = -0.5, hjust = -0.1, size = 2.5) +  # Add text labels for amounts at the end of bars with reduced size"
"0","  scale_x_date(date_breaks = ""1 year"", date_labels = ""%Y"", limits = c(extended_min_date, extended_max_date)) +"
"0","  labs(title = ""Active Awards Timeline by PI"","
"0","       x = ""Timeline"","
"0","       y = ""Principal Investigator"") +"
"0","  theme_minimal() +"
"0","  theme(legend.position = ""none"",  # Remove the legend"
"0","        plot.title = element_text(hjust = 0.5),"
"0","        axis.text.y = element_text(size = 6))  # Reduce the size of y-axis label"
