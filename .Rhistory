BSU_NIH_data  <- BSU_NIH_data %>%
mutate(grant_duration = `End Date` - `Start Date`)
BSU_NIH_data  <- BSU_NIH_data  %>%
mutate(grant_duration_years = as.numeric(grant_duration) / 365.25)
# COMPARISON BETWEEEN NSF - Grant Duration
library(readxl)
NIH_Compare_Data <- read_xlsx("NIH_Combined_Data.xlsx")
library(dplyr)
# Filter the data for each institution
UI_NIH_data <- NIH_Compare_Data %>%
filter(OrganizationName == "UNIVERSITY OF IDAHO")
BSU_NIH_data <- NIH_Compare_Data %>%
filter(OrganizationName == "BOISE STATE UNIVERSITY")
ISU_NIH_data <- NIH_Compare_Data %>%
filter(OrganizationName == "IDAHO STATE UNIVERSITY")
# Calculate the duration of grants for each institution
# Convert "Start Date" and "End Date" columns to date objects
#UI
UI_NIH_data <- UI_NIH_data%>%
mutate(`Start Date` = as.Date(ProjectStartDate, format = "%m/%d/%Y"),
`End Date` = as.Date(ProjectEndDate, format = "%m/%d/%Y"))
# Assuming 'grant_duration' is in days
UI_NIH_data <- UI_NIH_data %>%
mutate(grant_duration = `End Date` - `Start Date`)
UI_NIH_data <- UI_NIH_data %>%
mutate(grant_duration_years = as.numeric(grant_duration) / 365.25)
# BSU - no quiere funcionar no tengo la menor idea pq
BSU_NIH_data  <- BSU_NIH_data %>%
mutate(`Start Date` = as.Date(ProjectStartDate, format = "%m/%d/%Y"),
`End Date` = as.Date(ProjectEndDate, format = "%m/%d/%Y"))
# Assuming 'grant_duration' is in days
BSU_NIH_data  <- BSU_NIH_data %>%
mutate(grant_duration = `End Date` - `Start Date`)
BSU_NIH_data  <- BSU_NIH_data  %>%
mutate(grant_duration_years = as.numeric(grant_duration) / 365.25)
# ISU
ISU_NIH_data<- ISU_NIH_data %>%
mutate(`Start Date` = as.Date(ProjectStartDate, format = "%m/%d/%Y"),
`End Date` = as.Date(ProjectEndDate, format = "%m/%d/%Y"))
# Assuming 'grant_duration' is in days
ISU_NIH_data <- ISU_NIH_data %>%
mutate(grant_duration = `End Date` - `Start Date`)
ISU_NIH_data <- ISU_NIH_data %>%
mutate(grant_duration_years = as.numeric(grant_duration) / 365.25)
# Visualization
library(dplyr)
# Assuming UI_data contains the grant duration information for one institution
# and other_datasets contain the grant duration information for the other institutions
# Combine datasets
combined_data_NIH <- bind_rows(UI_NIH_data, BSU_NIH_data, ISU_NIH_data)
# Colors
my_colors_3 <- c("BOISE STATE UNIVERSITY" = "orange", "IDAHO STATE UNIVERSITY" = "black", "UNIVERSITY OF IDAHO" = "gold")
# Plotting grant duration as a bar graph
library(ggplot2)
ggplot(combined_data_NIH, aes(x = OrganizationName, y = grant_duration_years, fill = OrganizationName)) +
geom_bar(stat = "identity", position = "dodge") +
ggtitle("Grant Duration by Organization") +
xlab("") +
ylab("Grant Duration (Years)") +
scale_fill_manual(values = my_colors) +  # Apply custom colors
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 12),  # Adjust size of x-axis labels
axis.text.y = element_text(size = 12),  # Adjust size of y-axis labels
legend.text = element_text(size = 12),  # Adjust size of legend text
plot.title = element_text(hjust = 0.5, size = 14))  # Adjust size of plot title
# COMPARISON BETWEEEN NSF - Grant Duration
library(readxl)
NIH_Compare_Data <- read_xlsx("NIH_Combined_Data.xlsx")
library(dplyr)
# Filter the data for each institution
UI_NIH_data <- NIH_Compare_Data %>%
filter(OrganizationName == "UNIVERSITY OF IDAHO")
BSU_NIH_data <- NIH_Compare_Data %>%
filter(OrganizationName == "BOISE STATE UNIVERSITY")
ISU_NIH_data <- NIH_Compare_Data %>%
filter(OrganizationName == "IDAHO STATE UNIVERSITY")
# Calculate the duration of grants for each institution
# Convert "Start Date" and "End Date" columns to date objects
#UI
UI_NIH_data <- UI_NIH_data%>%
mutate(`Start Date` = as.Date(ProjectStartDate, format = "%m/%d/%Y"),
`End Date` = as.Date(ProjectEndDate, format = "%m/%d/%Y"))
# Assuming 'grant_duration' is in days
UI_NIH_data <- UI_NIH_data %>%
mutate(grant_duration = `End Date` - `Start Date`)
UI_NIH_data <- UI_NIH_data %>%
mutate(grant_duration_years = as.numeric(grant_duration) / 365.25)
# BSU - no quiere funcionar no tengo la menor idea pq
BSU_NIH_data  <- BSU_NIH_data %>%
mutate(`Start Date` = as.Date(ProjectStartDate, format = "%m/%d/%Y"),
`End Date` = as.Date(ProjectEndDate, format = "%m/%d/%Y"))
# Assuming 'grant_duration' is in days
BSU_NIH_data  <- BSU_NIH_data %>%
mutate(grant_duration = `End Date` - `Start Date`)
BSU_NIH_data  <- BSU_NIH_data  %>%
mutate(grant_duration_years = as.numeric(grant_duration) / 365.25)
# ISU
ISU_NIH_data<- ISU_NIH_data %>%
mutate(`Start Date` = as.Date(ProjectStartDate, format = "%m/%d/%Y"),
`End Date` = as.Date(ProjectEndDate, format = "%m/%d/%Y"))
# Assuming 'grant_duration' is in days
ISU_NIH_data <- ISU_NIH_data %>%
mutate(grant_duration = `End Date` - `Start Date`)
ISU_NIH_data <- ISU_NIH_data %>%
mutate(grant_duration_years = as.numeric(grant_duration) / 365.25)
# Visualization
library(dplyr)
# Assuming UI_data contains the grant duration information for one institution
# and other_datasets contain the grant duration information for the other institutions
# Combine datasets
combined_data_NIH <- bind_rows(UI_NIH_data, BSU_NIH_data, ISU_NIH_data)
# Colors
my_colors_3 <- c("BOISE STATE UNIVERSITY" = "orange", "IDAHO STATE UNIVERSITY" = "black", "UNIVERSITY OF IDAHO" = "gold")
# Plotting grant duration as a bar graph
library(ggplot2)
ggplot(combined_data_NIH, aes(x = OrganizationName, y = grant_duration_years, fill = OrganizationName)) +
geom_bar(stat = "identity", position = "dodge") +
ggtitle("Grant Duration by Organization") +
xlab("") +
ylab("Grant Duration (Years)") +
scale_fill_manual(values = my_colors_3) +  # Apply custom colors
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 12),  # Adjust size of x-axis labels
axis.text.y = element_text(size = 12),  # Adjust size of y-axis labels
legend.text = element_text(size = 12),  # Adjust size of legend text
plot.title = element_text(hjust = 0.5, size = 14))  # Adjust size of plot title
# COMPARISON BETWEEEN NSF - Grant Duration
library(readxl)
NIH_Compare_Data <- read_xlsx("NIH_Combined_Data.xlsx")
library(dplyr)
# Filter the data for each institution
UI_NIH_data <- NIH_Compare_Data %>%
filter(OrganizationName == "UNIVERSITY OF IDAHO")
BSU_NIH_data <- NIH_Compare_Data %>%
filter(OrganizationName == "BOISE STATE UNIVERSITY")
ISU_NIH_data <- NIH_Compare_Data %>%
filter(OrganizationName == "IDAHO STATE UNIVERSITY")
# Calculate the duration of grants for each institution
# Convert "Start Date" and "End Date" columns to date objects
#UI
UI_NIH_data <- UI_NIH_data%>%
mutate(`Start Date` = as.Date(ProjectStartDate, format = "%m/%d/%Y"),
`End Date` = as.Date(ProjectEndDate, format = "%m/%d/%Y"))
# Assuming 'grant_duration' is in days
UI_NIH_data <- UI_NIH_data %>%
mutate(grant_duration = `End Date` - `Start Date`)
UI_NIH_data <- UI_NIH_data %>%
mutate(grant_duration_years = as.numeric(grant_duration) / 365.25)
# BSU - no quiere funcionar no tengo la menor idea pq
BSU_NIH_data  <- BSU_NIH_data %>%
mutate(`Start Date` = as.Date(ProjectStartDate, format = "%m/%d/%Y"),
`End Date` = as.Date(ProjectEndDate, format = "%m/%d/%Y"))
# Assuming 'grant_duration' is in days
BSU_NIH_data  <- BSU_NIH_data %>%
mutate(grant_duration = `End Date` - `Start Date`)
BSU_NIH_data  <- BSU_NIH_data  %>%
mutate(grant_duration_years = as.numeric(grant_duration) / 365.25)
# ISU
ISU_NIH_data<- ISU_NIH_data %>%
mutate(`Start Date` = as.Date(ProjectStartDate, format = "%m/%d/%Y"),
`End Date` = as.Date(ProjectEndDate, format = "%m/%d/%Y"))
# Assuming 'grant_duration' is in days
ISU_NIH_data <- ISU_NIH_data %>%
mutate(grant_duration = `End Date` - `Start Date`)
ISU_NIH_data <- ISU_NIH_data %>%
mutate(grant_duration_years = as.numeric(grant_duration) / 365.25)
# Visualization
library(dplyr)
# Assuming UI_data contains the grant duration information for one institution
# and other_datasets contain the grant duration information for the other institutions
# Combine datasets
combined_data_NIH <- bind_rows(UI_NIH_data, BSU_NIH_data, ISU_NIH_data)
# Colors
my_colors_3 <- c("BOISE STATE UNIVERSITY" = "orange", "IDAHO STATE UNIVERSITY" = "black", "UNIVERSITY OF IDAHO" = "gold")
# Plotting grant duration as a bar graph
library(ggplot2)
ggplot(combined_data_NIH, aes(x = OrganizationName, y = grant_duration_years, fill = OrganizationName)) +
geom_bar(stat = "identity", position = "dodge") +
ggtitle("Grant Duration by Organization") +
xlab("") +
ylab("Grant Duration (Years)") +
scale_fill_manual(values = my_colors_3) +  # Apply custom colors
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 12),  # Adjust size of x-axis labels
axis.text.y = element_text(size = 12),  # Adjust size of y-axis labels
legend.text = element_text(size = 12),  # Adjust size of legend text
plot.title = element_text(hjust = 0.5, size = 14))  # Adjust size of plot title
# Calculate total award money for each institution
NIH_total_award_money <- NIH_Compare_Data %>%
group_by(OrganizationName) %>%
summarise(NIH_total_award_money = sum(TotalCost))
View(NIH_total_award_money)
# Calculate total award money for each institution, skipping NA values
NIH_total_award_money <- NIH_Compare_Data %>%
group_by(OrganizationName) %>%
summarise(NIH_total_award_money = sum(TotalCost, na.rm = TRUE))
# Convert TotalCost column to numeric, ignoring non-numeric entries
NIH_Compare_Data <- NIH_Compare_Data %>%
mutate(TotalCost = as.numeric(as.character(TotalCost)))
# Calculate total award money for each institution, skipping NA values
NIH_total_award_money <- NIH_Compare_Data %>%
group_by(OrganizationName) %>%
summarise(NIH_total_award_money = sum(TotalCost, na.rm = TRUE))
# COMPARISON BETWEEEN NIH - AWARD MONEY
library(dplyr)
library(ggplot2)
# Convert TotalCost column to numeric, ignoring non-numeric entries
NIH_Compare_Data <- NIH_Compare_Data %>%
mutate(TotalCost = as.numeric(as.character(TotalCost)))
# Calculate total award money for each institution, skipping NA values
NIH_total_award_money <- NIH_Compare_Data %>%
group_by(OrganizationName) %>%
summarise(NIH_total_award_money = sum(TotalCost, na.rm = TRUE))
# COMPARISON BETWEEEN NIH - AWARD MONEY
library(dplyr)
library(ggplot2)
# Remove rows with NA values in TotalCost column
NIH_Compare_Data <- NIH_Compare_Data %>%
filter(!is.na(TotalCost))
# Calculate total award money for each institution
NIH_total_award_money <- NIH_Compare_Data %>%
group_by(OrganizationName) %>%
summarise(NIH_total_award_money = sum(TotalCost))
# COMPARISON BETWEEEN NIH - AWARD MONEY
library(dplyr)
library(ggplot2)
# Convert TotalCost column to numeric, ignoring non-numeric entries
NIH_Compare_Data <- NIH_Compare_Data %>%
mutate(TotalCost = as.numeric(as.character(TotalCost)))
# Calculate total award money for each institution, skipping NA values
NIH_total_award_money <- NIH_Compare_Data %>%
group_by(OrganizationName) %>%
summarise(NIH_total_award_money = sum(TotalCost, na.rm = TRUE))
NIH_Compare_Data <- read_xlsx("NIH_Combined_Data.xlsx")
library(readxl)
NIH_Compare_Data <- read_xlsx("NIH_Combined_Data.xlsx")
View(NIH_Compare_Data)
# Calculate total award money for each institution
NIH_total_award_money <- NIH_Compare_Data %>%
group_by(OrganizationName) %>%
summarise(NIH_total_award_money = sum(TotalCost))
# Calculate total award money for each institution
NIH_total_award_money <- NIH_Compare_Data %>%
group_by(OrganizationName) %>%
summarise(NIH_total_award_money = sum(TotalCost))
# Calculate total award money for each institution, removing NA values in TotalCost
NIH_total_award_money <- NIH_Compare_Data %>%
filter(!is.na(TotalCost)) %>%
group_by(OrganizationName) %>%
summarise(NIH_total_award_money = sum(TotalCost))
# Calculate total award money for each institution, removing NA values in TotalCost
NIH_total_award_money <- NIH_Compare_Data %>%
group_by(OrganizationName) %>%
summarise(NIH_total_award_money = sum(TotalCost))
# Calculate total award money for each institution, removing NA values in TotalCost
NIH_total_award_money <- NIH_Compare_Data %>%
group_by(OrganizationName) %>%
summarise(NIH_total_award_money = sum(TotalCost))
View(NSF_total_award_money)
# Calculate total award money for each institution, excluding NA values in TotalCost
NIH_total_award_money <- NIH_Compare_Data %>%
group_by(OrganizationName) %>%
summarise(NIH_total_award_money = sum(TotalCost, na.rm = TRUE))
# COMPARISON BETWEEEN NIH - AWARD MONEY
library(dplyr)
library(ggplot2)
# Calculate total award money for each institution, removing NA values in TotalCost
library(dplyr)
# Calculate total award money for each institution, excluding NA values in TotalCost
NIH_total_award_money <- NIH_Compare_Data %>%
group_by(OrganizationName) %>%
summarise(NIH_total_award_money = sum(TotalCost, na.rm = TRUE))
# COMPARISON BETWEEEN NIH - AWARD MONEY
library(dplyr)
library(ggplot2)
# Calculate total award money for each institution, removing NA values in TotalCost
# Calculate total award money for each institution, excluding NA values in TotalCost
NIH_total_award_money <- NIH_Compare_Data %>%
group_by(OrganizationName) %>%
summarise(NIH_total_award_money = sum(TotalCost, na.rm = TRUE))
# COMPARISON BETWEEEN NIH - AWARD MONEY
library(dplyr)
library(ggplot2)
# Calculate total award money for each institution, removing NA values in TotalCost
# Calculate total award money for each institution, excluding NA values in TotalCost
NIH_average_award_money <- NIH_Compare_Data %>%
group_by(OrganizationName) %>%
summarise(NIH_average_award_money = mean(TotalCost, na.rm = TRUE))
# COMPARISON BETWEEEN NIH - AWARD MONEY
library(dplyr)
library(ggplot2)
# Calculate total award money for each institution, removing NA values in TotalCost
# Calculate total award money for each institution, excluding NA values in TotalCost
NIH_average_award_money <- NIH_Compare_Data %>%
filter(!is.na(TotalCost)) %>%
group_by(OrganizationName) %>%
summarise(NIH_average_award_money = mean(TotalCost))
View(NIH_average_award_money)
View(NIH_average_award_money)
View(NIH_average_award_money)
View(NIH_average_award_money)
View(NIH_average_award_money)
View(NIH_average_award_money)
View(NIH_average_award_money)
# COMPARISON BETWEEEN NIH - AWARD MONEY - CALCULATED THE AVERAGE INSTEAD THE TOTAL AMMOUNT
library(dplyr)
library(ggplot2)
# Calculate total award money for each institution, removing NA values in TotalCost
# Calculate total award money for each institution, excluding NA values in TotalCost
NIH_average_award_money <- NIH_Compare_Data %>%
filter(!is.na(TotalCost)) %>%
group_by(OrganizationName) %>%
summarise(NIH_average_award_money = mean(TotalCost))
NIH_total_award_money <- NIH_Compare_Data %>%
group_by(OrganizationName) %>%
summarise(NIH_total_award_money = sum(TotalCost, na.rm = TRUE))
View(NIH_total_award_money)
# COMPARISON BETWEEEN NIH - AWARD MONEY - CALCULATED THE AVERAGE INSTEAD THE TOTAL AMMOUNT
library(dplyr)
library(ggplot2)
# Calculate total award money for each institution, removing NA values in TotalCost
NIH_total_award_money <- NIH_Compare_Data %>%
group_by(OrganizationName) %>%
summarise(NIH_total_award_money = sum(TotalCost, na.rm = TRUE))
# Colors
my_colors_3 <- c("BOISE STATE UNIVERSITY" = "orange", "IDAHO STATE UNIVERSITY" = "black", "UNIVERSITY OF IDAHO" = "gold")
# COMPARISON BETWEEEN NIH - AWARD MONEY - CALCULATED THE AVERAGE INSTEAD THE TOTAL AMMOUNT
library(dplyr)
library(ggplot2)
# Calculate total award money for each institution, removing NA values in TotalCost
NIH_total_award_money <- NIH_Compare_Data %>%
group_by(OrganizationName) %>%
summarise(NIH_total_award_money = sum(TotalCost, na.rm = TRUE))
# Colors
my_colors_3 <- c("BOISE STATE UNIVERSITY" = "orange", "IDAHO STATE UNIVERSITY" = "black", "UNIVERSITY OF IDAHO" = "gold")
library(ggplot2)
ggplot(NIH_total_award_money, aes(x = OrganizationName, y = NIH_total_award_money)) +
geom_bar(stat = "identity", position = "dodge", fill = my_colors_3)  +
ggtitle("Total of Award Money from NSF Grants") +
xlab("") +
ylab("Total Award Money") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 12),  # Adjust size of x-axis labels
axis.text.y = element_text(size = 12),  # Adjust size of y-axis labels
legend.text = element_text(size = 12),  # Adjust size of legend text
plot.title = element_text(hjust = 0.5, size = 14)) +  # Adjust size of plot title
scale_y_continuous(labels = scales::number_format(scale = 1e-6, suffix = "M"))
# COMPARISON BETWEEEN NIH - AWARD MONEY - CALCULATED THE AVERAGE INSTEAD THE TOTAL AMMOUNT
library(dplyr)
library(ggplot2)
# Calculate total award money for each institution, removing NA values in TotalCost
NIH_total_award_money <- NIH_Compare_Data %>%
group_by(OrganizationName) %>%
summarise(NIH_total_award_money = sum(TotalCost, na.rm = TRUE))
# Colors
my_colors_3 <- c("BOISE STATE UNIVERSITY" = "orange", "IDAHO STATE UNIVERSITY" = "black", "UNIVERSITY OF IDAHO" = "gold")
library(ggplot2)
ggplot(NIH_total_award_money, aes(x = OrganizationName, y = NIH_total_award_money)) +
geom_bar(stat = "identity", position = "dodge", fill = my_colors_3)  +
ggtitle("Total of Award Money from NIH Grants") +
xlab("") +
ylab("Total Award Money") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 12),  # Adjust size of x-axis labels
axis.text.y = element_text(size = 12),  # Adjust size of y-axis labels
legend.text = element_text(size = 12),  # Adjust size of legend text
plot.title = element_text(hjust = 0.5, size = 14)) +  # Adjust size of plot title
scale_y_continuous(labels = scales::number_format(scale = 1e-6, suffix = "M"))
UI_NIH_data_2 <- UI_NIH_data_2%>%
mutate(`Award Notice Date` = as.Date(AwardNoticeDate, format = "%m/%d/%Y"),
`End Date` = as.Date(ProjectEndDate, format = "%m/%d/%Y"))
# Filter the data for each institution
UI_NIH_data_2 <- NIH_Compare_Data %>%
filter(OrganizationName == "UNIVERSITY OF IDAHO")
UI_NIH_data_2 <- UI_NIH_data_2%>%
mutate(`Award Notice Date` = as.Date(AwardNoticeDate, format = "%m/%d/%Y"),
`End Date` = as.Date(ProjectEndDate, format = "%m/%d/%Y"))
View(UI_NIH_data_2)
NSF_Compare_Data <- read_xlsx("NSF_Combined_Data.xlsx")
View(NSF_Compare_Data)
# Calculate total grant action count for each institution
NSF_Grant_Award_Instrument <- NSF_Compare_Data %>%
group_by(Organization, AwardInstrument) %>%
summarise(count = n(), .groups = "drop") %>%
ungroup()
View(NSF_Grant_Award_Instrument)
# COMPARISON BETWEEEN NSF - Grant Status
library(dplyr)
library(ggplot2)
# Calculate total grant action count for each institution
NSF_Grant_Award_Instrument <- NSF_Compare_Data %>%
group_by(Organization, AwardInstrument) %>%
summarise(count = n(), .groups = "drop") %>%
ungroup()
library(ggplot2)
# Assuming DOE_Grant_Action is your summarized data frame with counts of Action Type by Institution
ggplot(NSF_Grant_Award_Instrument , aes(x = Organization, y = count, fill = AwardInstrument)) +
geom_bar(stat = "identity", position = "dodge") +
ggtitle("Number of Counts of Action Type by Institution") +
xlab("") +
ylab("Number of Active Grants") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 12),  # Adjust size of x-axis labels
axis.text.y = element_text(size = 12),  # Adjust size of y-axis labels
legend.text = element_text(size = 12),  # Adjust size of legend text
plot.title = element_text(hjust = 0.5, size = 14))
# COMPARISON BETWEEEN NSF - Grant Status
library(dplyr)
library(ggplot2)
# Calculate total grant action count for each institution
NSF_Grant_Award_Instrument <- NSF_Compare_Data %>%
group_by(Organization, AwardInstrument) %>%
summarise(count = n(), .groups = "drop") %>%
ungroup()
library(ggplot2)
# Assuming DOE_Grant_Action is your summarized data frame with counts of Action Type by Institution
my_colors_4 <- c("navyblue", "darkgreen", "darkorange", "darkred")
ggplot(NSF_Grant_Award_Instrument , aes(x = Organization, y = count, fill = AwardInstrument)) +
geom_bar(stat = "identity", position = "dodge",  fill = my_colors_4) +
ggtitle("Number of Counts of Action Type by Institution") +
xlab("") +
ylab("Number of Active Grants") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 12),  # Adjust size of x-axis labels
axis.text.y = element_text(size = 12),  # Adjust size of y-axis labels
legend.text = element_text(size = 12),  # Adjust size of legend text
plot.title = element_text(hjust = 0.5, size = 14))
# COMPARISON BETWEEEN NSF - Grant Status
library(dplyr)
library(ggplot2)
# Calculate total grant action count for each institution
NSF_Grant_Award_Instrument <- NSF_Compare_Data %>%
group_by(Organization, AwardInstrument) %>%
summarise(count = n(), .groups = "drop") %>%
ungroup()
# Check unique levels of AwardInstrument
unique_levels <- unique(NSF_Grant_Award_Instrument$AwardInstrument)
# Adjust my_colors_4 to match the number of unique levels
my_colors_4 <- rainbow(length(unique_levels))  # or any other color palette you prefer
# Plot with adjusted colors
ggplot(NSF_Grant_Award_Instrument, aes(x = Organization, y = count, fill = AwardInstrument)) +
geom_bar(stat = "identity", position = "dodge", fill = my_colors_4) +
ggtitle("Number of Counts of Action Type by Institution") +
xlab("") +
ylab("Number of Active Grants") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 12),
axis.text.y = element_text(size = 12),
legend.text = element_text(size = 12),
plot.title = element_text(hjust = 0.5, size = 14))
# COMPARISON BETWEEEN NSF - Grant Status
library(dplyr)
library(ggplot2)
# Calculate total grant action count for each institution
NSF_Grant_Award_Instrument <- NSF_Compare_Data %>%
group_by(Organization, AwardInstrument) %>%
summarise(count = n(), .groups = "drop") %>%
ungroup()
# Check unique levels of AwardInstrument
unique_levels <- unique(NSF_Grant_Award_Instrument$AwardInstrument)
# Adjust my_colors_4 to match the number of unique levels
my_colors_4 <- rainbow(length(unique_levels))  # or any other color palette you prefer
# Plot with adjusted colors
ggplot(NSF_Grant_Award_Instrument, aes(x = Organization, y = count, fill = AwardInstrument)) +
geom_bar(stat = "identity", position = "dodge") +
ggtitle("Number of Counts of Action Type by Institution") +
xlab("") +
ylab("Number of Active Grants") +
scale_fill_manual(values = my_colors_4) +  # Add this line to set custom colors
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 12),
axis.text.y = element_text(size = 12),
legend.text = element_text(size = 12),
plot.title = element_text(hjust = 0.5, size = 14))
# COMPARISON BETWEEEN NSF - Grant Status
library(dplyr)
library(ggplot2)
# Calculate total grant action count for each institution
NSF_Grant_Award_Instrument <- NSF_Compare_Data %>%
group_by(Organization, AwardInstrument) %>%
summarise(count = n(), .groups = "drop") %>%
ungroup()
# Check unique levels of AwardInstrument
unique_levels <- unique(NSF_Grant_Award_Instrument$AwardInstrument)
# Adjust my_colors_4 to match the number of unique levels
my_colors_4 <- ("navyblue", "darkgreen", "darkorange", "darkred")  # or any other color palette you prefer
# Adjust my_colors_4 to match the number of unique levels
my_colors_4 <- ("navyblue", "darkgreen", "darkorange", "darkred")  # or any other color palette you prefer
# COMPARISON BETWEEEN NSF - Grant Status
library(dplyr)
library(ggplot2)
# Calculate total grant action count for each institution
NSF_Grant_Award_Instrument <- NSF_Compare_Data %>%
group_by(Organization, AwardInstrument) %>%
summarise(count = n(), .groups = "drop") %>%
ungroup()
# Check unique levels of AwardInstrument
unique_levels <- unique(NSF_Grant_Award_Instrument$AwardInstrument)
# Adjust my_colors_4 to match the number of unique levels
my_colors_4 <- c("navyblue", "darkgreen", "darkorange", "darkred")  # or any other color palette you prefer
# Plot with adjusted colors
ggplot(NSF_Grant_Award_Instrument, aes(x = Organization, y = count, fill = AwardInstrument)) +
geom_bar(stat = "identity", position = "dodge") +
ggtitle("Number of Counts of Action Type by Institution") +
xlab("") +
ylab("Number of Active Grants") +
scale_fill_manual(values = my_colors_4) +  # Add this line to set custom colors
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 12),
axis.text.y = element_text(size = 12),
legend.text = element_text(size = 12),
plot.title = element_text(hjust = 0.5, size = 14))
