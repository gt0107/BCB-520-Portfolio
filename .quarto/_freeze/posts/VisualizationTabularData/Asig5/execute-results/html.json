{
  "hash": "4da59bfdca65f1e9c2fbd25374d94650",
  "result": {
    "markdown": "---\ntitle: Hockey Analytics\nsubtitle: Visaulization for Tabular Data\nauthor: Geraline Trossi-Torres\nDate: 2024-02-25\ncategories: [Assignment, DataViz, Visualization]\nimage: Profile3.jpg\ncode-fold: true\ncode-tools: true\ndescription: 2024 NHL Draft Picks\n---\n\n\n## DATA SET FOR NHL DRAFT PICKS\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(readxl)\nNHL_Drafts <- read_excel(\"NHLDraftsPicks.xlsx\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nNew names:\n• `` -> `...1`\n```\n:::\n\n```{.r .cell-code}\nknitr::kable(head(NHL_Drafts,10))\n```\n\n::: {.cell-output-display}\n| ...1| draftyear|name      | round| overall| pickinRound| height| weight|position | playerId| postdraft| NHLgames| goals| assists| points|\n|----:|---------:|:---------|-----:|-------:|-----------:|------:|------:|:--------|--------:|---------:|--------:|-----:|-------:|------:|\n|    1|      2001|Drew Fata |     3|      86|          23|     73|    209|Defense  |  8469535|        10|        0|     0|       0|      0|\n|    2|      2001|Drew Fata |     3|      86|          23|     73|    209|Defense  |  8469535|        11|        0|     0|       0|      0|\n|    3|      2001|Drew Fata |     3|      86|          23|     73|    209|Defense  |  8469535|        12|        0|     0|       0|      0|\n|    4|      2001|Drew Fata |     3|      86|          23|     73|    209|Defense  |  8469535|        13|        0|     0|       0|      0|\n|    5|      2001|Drew Fata |     3|      86|          23|     73|    209|Defense  |  8469535|         2|        0|     0|       0|      0|\n|    6|      2001|Drew Fata |     3|      86|          23|     73|    209|Defense  |  8469535|         3|        0|     0|       0|      0|\n|    7|      2001|Drew Fata |     3|      86|          23|     73|    209|Defense  |  8469535|         5|        3|     1|       0|      1|\n|    8|      2001|Drew Fata |     3|      86|          23|     73|    209|Defense  |  8469535|         6|        5|     0|       1|      1|\n|    9|      2001|Drew Fata |     3|      86|          23|     73|    209|Defense  |  8469535|         7|        0|     0|       0|      0|\n|   10|      2001|Drew Fata |     3|      86|          23|     73|    209|Defense  |  8469535|         8|        0|     0|       0|      0|\n:::\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.5\n✔ forcats   1.0.0     ✔ stringr   1.5.1\n✔ ggplot2   3.4.4     ✔ tibble    3.2.1\n✔ lubridate 1.9.3     ✔ tidyr     1.3.0\n✔ purrr     1.0.2     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n:::\n:::\n\n\n## SIMPLE SCATTERPLOT\n\n\n::: {.cell}\n\n```{.r .cell-code}\nDraft_2022 <- NHL_Drafts %>%\n  filter(draftyear==2022)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ggplot2)\n\nggplot(Draft_2022, aes(x = round, y = NHLgames)) +\n  geom_point()\n```\n\n::: {.cell-output-display}\n![](Asig5_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\n**Figure 1:**The players that were drafted in June of 2022 didn’t play to much the last season.\n\nThings wrong with this Data Visualization:\n\n  1.**Overplotting:** All those points on the y=0 line represent about 32 players each. Can you         think of a way that adding extra channels might help?\n  \n  2.**Labelling:** Can we create a solid figure caption and better axis labels for this figure? In        your caption, please specify the task(s) the visualizaiton is intended to facilitate, as well       as the marks, channels, and key-value pairs used.\n  \n  3.**Key-Value pairs:** Looks like we are using “round” as a continuous variable. Can we change          this to an ordered factor?\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ggplot2)\nlibrary(ggridges)\n\nDraft_2022$round <- factor(Draft_2022$round, levels = sort(unique(Draft_2022$round)), ordered = TRUE)\n\nggplot(Draft_2022, aes(x = NHLgames, y = round)) +\n  geom_density_ridges(aes(height = ..density..), jittered_points = TRUE, scale = 3) +\n  theme_minimal() +\n  ggtitle(\"NHL 2022 Draft Players Density\") +\n  xlab(\"NHL Games Played\") + \n  ylab(\"Draft Round\")+\n  theme(plot.title = element_text(hjust = 0.5))\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: The dot-dot notation (`..density..`) was deprecated in ggplot2 3.4.0.\nℹ Please use `after_stat(density)` instead.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nPicking joint bandwidth of 0.23\n```\n:::\n\n::: {.cell-output-display}\n![](Asig5_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\n**Figure 2:**specify the task(s) the visualizaiton is intended to facilitate, as well as the marks, channels, and key-value pairs used\n\n## EXPANDED SCATTERPLOT\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(dplyr)\nlibrary(ggplot2)\n\nDraft_2018 <- NHL_Drafts %>%\n  filter(draftyear == 2018 & postdraft < 6)\n\nggplot(Draft_2018, aes(x = round, y = NHLgames)) +\n  geom_point()\n```\n\n::: {.cell-output-display}\n![](Asig5_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\n**Figure 1:**\n\n\n::: {.cell}\n\n```{.r .cell-code}\nSummaryDraft2018 <- Draft_2018 %>%\n  group_by(playerId, round, overall, position, name) %>%\n  summarise(totgames=sum(NHLgames))\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`summarise()` has grouped output by 'playerId', 'round', 'overall', 'position'.\nYou can override using the `.groups` argument.\n```\n:::\n\n```{.r .cell-code}\nggplot(SummaryDraft2018, aes(x=round, y=totgames))+\n  geom_point()\n```\n\n::: {.cell-output-display}\n![](Asig5_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\n**Figure 2:**\n\n  1.**Overplotting:** All those points on the y=0 line represent about 32 players each. Can you         think of a way that adding extra channels might help?\n  \n  2.**Labelling:** Can we create a solid figure caption and better axis labels for this figure? In        your caption, please specify the task(s) the visualizaiton is intended to facilitate, as well       as the marks, channels, and key-value pairs used.\n  \n  3.**Key-Value pairs:** Looks like we are using “round” as a continuous variable. Can we change          this to an ordered factor?\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(dplyr)\nlibrary(ggplot2)\n\nSummaryDraft2018 <- Draft_2018 %>%\n  group_by(playerId, round, overall, position, name) %>%\n  summarise(totgames = sum(NHLgames, na.rm = TRUE), .groups = 'drop')  # Handle NA values\n\nSummaryDraft2018$round <- factor(SummaryDraft2018$round, \n                                 levels = sort(unique(SummaryDraft2018$round)), \n                                 ordered = TRUE)\n\nggplot(SummaryDraft2018, aes(x = round, y = totgames, color = position)) +\n  geom_point() +\n  theme_minimal() +\n  ggtitle(\"Total NHL Games by Draft Round (2018)\") +\n  xlab(\"Draft Round\") +\n  ylab(\"Total NHL Games Played\") +\n  theme(plot.title = element_text(hjust = 0.5))\n```\n\n::: {.cell-output-display}\n![](Asig5_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\n**Figure 3:** In your caption, please specify the task(s) the visualization is intended to facilitate, as well as the marks, channels, and key-value pairs used.\n\n##SCATTERPLOT WITH OVERALL DRAFT POSITION\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(SummaryDraft2018, aes(x=overall, y=totgames))+\n  geom_point()\n```\n\n::: {.cell-output-display}\n![](Asig5_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\n**Figure 4:**\n\n  1.We are trying to address the notion of trading a pick from round 1 for picks from round 2 and 3. Add visual channels to        this plot that will help us make that decision.\n  \n  2.Create a caption and better axis labels for this figure.\n  \n  3.What if we wanted to use more than just the 2018 draft class?\n  \n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ggplot2)\n\nSummaryDraft2018$round <- as.factor(SummaryDraft2018$round)\n\nggplot(SummaryDraft2018, aes(x = overall, y = totgames, fill = round)) +  # Use 'fill' instead of 'color' for the aes\n  geom_point(shape = 21, alpha = 0.6, size = 3, colour = \"black\") +  # shape 21 allows for both fill and color\n  scale_fill_manual(values = c(\"1\" = \"blue\", \"2\" = \"red\", \"3\" = \"green\", \"4\" = \"purple\", \"5\" = \"orange\", \"6\" = \"magenta\", \"7\" = \"gold\")) +\n  theme_minimal() +\n  labs(title = \"Total NHL Games Played by Draft Position\",\n       x = \"Overall Draft Position\",\n       y = \"Total NHL Games Played\",\n       fill = \"Draft Round\") +  # Change 'color' to 'fill' in the legend title\n  theme(plot.title = element_text(hjust = 0.5))\n```\n\n::: {.cell-output-display}\n![](Asig5_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n\n**Figure 5:**\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(dplyr)\nlibrary(ggplot2)\n\nDraft_2019 <- NHL_Drafts %>%\n  filter(draftyear == 2019 & postdraft < 6)\n\nSummaryDraft2019 <- Draft_2019 %>%\n  group_by(playerId, round, overall, position, name) %>%\n  summarise(totgames = sum(NHLgames, na.rm = TRUE), .groups = 'drop')  # Handle NA values\n\nSummaryDraft2019$round <- factor(SummaryDraft2019$round, \n                                 levels = sort(unique(SummaryDraft2019$round)), \n                                 ordered = TRUE)\n\nSummaryDraft2018$Year <- 2018\nSummaryDraft2019$Year <- 2019\n\nCombinedDrafts <- rbind(SummaryDraft2018, SummaryDraft2019)\n\n\nlibrary(ggplot2)\n\nCombinedDrafts$round <- as.factor(CombinedDrafts$round)\n\n\nggplot(CombinedDrafts, aes(x = overall, y = totgames, fill = as.factor(Year))) +\n  geom_point(shape = 21, alpha = 0.6, size = 3, colour = \"black\") +  \n  scale_fill_manual(values = c(\"2018\" = \"blue\", \"2019\" = \"red\")) +\n  facet_wrap(~ round, ncol = 3) +\n  theme_minimal() +\n  labs(title = \"Total NHL Games Played by Draft Position (2018 & 2019)\",\n       x = \"Overall Draft Position\",\n       y = \"Total NHL Games Played\",\n       fill = \"Draft Year\") +\n  theme(plot.title = element_text(hjust = 0.5))\n```\n\n::: {.cell-output-display}\n![](Asig5_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(CombinedDrafts, aes(x = overall, y = totgames, color = as.factor(Year))) +\n  geom_point(alpha = 0.6, size = 3) +\n  scale_color_manual(values = c(\"2018\" = \"blue\", \"2019\" = \"red\")) +\n  theme_minimal() +\n  labs(title = \"Total NHL Games Played by Draft Position (2018 & 2019)\",\n       x = \"Overall Draft Position\",\n       y = \"Total NHL Games Played\",\n       color = \"Draft Year\") +\n  theme(plot.title = element_text(hjust = 0.5))\n```\n\n::: {.cell-output-display}\n![](Asig5_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n\n**Figure 6:**\n\n##SCATTERPLOT SUMMARY\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ggplot2)\n\n# Convert 'round' to numeric for plotting (if not already numeric)\nSummaryDraft2018$round_numeric <- as.numeric(as.character(SummaryDraft2018$round))\n\nggplot(SummaryDraft2018, aes(x = round_numeric, y = totgames)) +\n  geom_point() +\n  geom_smooth(method = \"loess\", se = TRUE)  # Using LOESS; for linear model, use method = \"lm\"\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`geom_smooth()` using formula = 'y ~ x'\n```\n:::\n\n::: {.cell-output-display}\n![](Asig5_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nDraftTotal <-NHL_Drafts%>%\n  filter(postdraft<8)%>%\n  group_by(playerId, round, overall, position, name)%>%\n  summarise(totgames=sum(NHLgames))\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`summarise()` has grouped output by 'playerId', 'round', 'overall', 'position'.\nYou can override using the `.groups` argument.\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(DraftTotal, aes(x = overall, y = totgames)) +\n  geom_smooth()\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`geom_smooth()` using method = 'gam' and formula = 'y ~ s(x, bs = \"cs\")'\n```\n:::\n\n::: {.cell-output-display}\n![](Asig5_files/figure-html/unnamed-chunk-14-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nGettingTotalDrafts <-NHL_Drafts%>%\n  group_by(playerId, round, overall, position, name)%>%\n  summarise(totgames=sum(NHLgames))\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`summarise()` has grouped output by 'playerId', 'round', 'overall', 'position'.\nYou can override using the `.groups` argument.\n```\n:::\n:::",
    "supporting": [
      "Asig5_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}