{
  "hash": "ab2ca40e69dfff39a06190c454b1feb7",
  "result": {
    "markdown": "---\ntitle: \"Hockey Analytics\"\nsubtitle: \"Visualizations for Tabular Data\"\nauthor: \"Geraline Trossi-Torres\"\ndate: \"2024-02-29\"\ncategories: [Assignment, DataViz, Visualization]\nimage: \"Profile3.jpg\"\ncode-fold: true\ncode-tools: true\ndescription: \"Lets learn about hockey draft analytics\"\n---\n\n\n## OVERVIEW\n\nIn this assignment, we are going to practice creating visualizations for tabular data. Unlike previous assignments, however, this time we will all be using the same data sets. I'm doing this because I want everyone to engage in the same logic process and have the same design objectives in mind.\n\n## LEARNING OBJECTIVES\n\n1.  Demonstrate that you can manipulate tabular data to facilitate different visualization tasks. The minimum skills are FILTERING, SELECTING, and SUMMARIZING, all while GROUPING these operations as dictated by your data.\n2.  Demonstrate that you can use tabular data to explore, analyze, and choose the most appropriate visualization idioms given a specific motivating question.\n3.  Demonstrate that you can Find, Access, and Integrate additional data in order to fully address the motivating question.\n\nThe scenario below will allow you to complete the assignment. It deals with data that are of the appropriate complexity and extent (number of observations and variables) to challenge you. If you want to use different data (yours or from another source) I am happy to work with you to make that happen!\n\n## SCENARIO\n\nImagine you are a high priced data science consultant. One of your good friends, Cassandra Canuck, is an Assistant General Manager for the Vancouver Canucks, a team in the National Hockey League with a long, long.... long history of futility.\n\nThis season feels different.\n\nThe Canucks are currently among the league leaders and appear to be on their way to their first playoff appearance in many years. A few weeks ago, the Vancouver Canucks decided to trade an underperforming player with a high upside and their first round draft pick to the Calgary Flames for Elias Lindholm, a very solid forward that might prove to be the missing piece of their Stanley Cup puzzle. Exciting!\n\nExcept that now the Canucks are struggling. They've lost 4 straight games and have seemingly lost their identity as a team. The fans are questioning whether the trade was worth it. Woe is me!\n\nFor the purposes of this exercise, let's set the 2024 NHL draft order using the [Tankathon Simulator](https://www.tankathon.com/nhl). The NHL uses a lottery system in which the teams lowest in the standings have the highest odds of getting the first overall pick. This year the Canucks are at the top of the league, and positioned to have the 31st overall pick. According to the simulator, Calgary will pick at number 2 (which is very valuable!), and the Canuck's pick at 31.\n\nHere is a screenshot:\n\n![](NHLlottery.png)\n\n### Here is the question:\n\nWas the trade worth it? This trade has a high likelihood of becoming what we call a **rental**. Elias Lindholm is on an expiring contract, meaning Vancouver is guaranteed to hold his contract only through the end of the season. They might be able to extend him, but that depends on the salary cap.\n\nMeanwhile, Calgary can draft a player at position 31, who may or may not turn out to be of equal or greater value than Lindholm.\n\nWas the trade worth it? Did Vancouver or Calgary \"win\" the trade?\n\nCan we make some visualizations that help us answer this question?\n\n[Here is an article](https://puckpedia.com/PerriPickValue) on modeling draft pick value!\n\n[Original analysis!](https://www.statsportsconsulting.com/2016/05/26/1658/?platform=hootsuite)\n\n[Eric Tulsky's original paper\\*](https://www.broadstreethockey.com/post/nhl-draft-pick-value-trading-up/)\n\n## DIRECTIONS\n\nCreate a new post in your portfolio for this assignment. Call it something cool, like NHL draft analysis, or Hockey Analytics, or John Wick....\n\nCopy the data files from the repository, and maybe also the .qmd file.\n\nUse the .qmd file as the backbone of your assignment, changing the code and the markdown text as you go.\n\n## THE DATA\n\nHow can we evaluate whether trading a first round pick for a rental player is a good idea? One approach is to look at the historical performance of players from various draft positions.\n\nI've created a data set that will allow us to explore player performance as a function of draft position. If you are curious as to how I obtained and re-arranged these data, you can check out that tutorial [here](../T6-APIsandJSON/index.qmd). For this assignment, though, I want to focus on the visualizations.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nNHLDraft<-read.csv(\"NHLDraft.csv\")\nNHLDictionary<-read_excel(\"NHLDictionary.xlsx\")\n\nknitr::kable(NHLDictionary)\n```\n\n::: {.cell-output-display}\n|Attribute   |Type         |Description                                                                                                           |\n|:-----------|:------------|:---------------------------------------------------------------------------------------------------------------------|\n|draftyear   |Ordinal      |Calendar year in which the player was drafted into the NHL.                                                           |\n|name        |Item         |Full name of the player.                                                                                              |\n|round       |Ordinal      |Round in which the player was drafted (1 to 7).                                                                       |\n|overall     |Ordinal      |Overall draft position of the player (1 to 224)                                                                       |\n|pickinRound |Ordinal      |Position in which the player was drafted in their round (1 to 32).                                                    |\n|height      |Quantitative |Player height in inches.                                                                                              |\n|weight      |Quantitative |Player weight in pounds.                                                                                              |\n|position    |Categorical  |Player position (Forward, Defense, Goaltender)                                                                        |\n|playerId    |Item         |Unique ID (key) assigned to each player.                                                                              |\n|postdraft   |Ordinal      |Number of seasons since being drafted (0 to 20).                                                                      |\n|NHLgames    |Quantitative |Number of games played in the NHL in that particular season (regular season is 82 games, playoffs are up to 28 more). |\n:::\n:::\n\n\nIn this case, we have a dataframe with all the drafted players from 2000-2018, their position, their draft year and position, and then rows for each season since being drafted (`postdraft`). The key variable here is `NHLgames`, which tells us how many games they played in the NHL each season since being drafted. Whether drafted players even make the NHL, and how many games they play, might be a good proxy to understand the value of a draft pick we just traded away.\n\n::: callout-note\n## HINT\n\nIn the GitHub repository there is a file called `NHLdraftstats.csv`. What's in there? Can we use that information?\n:::\n\n## ANALYTICS REGARDING IF THE TRADE WAS WORTH IT\n\n### 2013 Draft Picks\n\n\n::: {.cell}\n\n```{.r .cell-code}\nNHLdraftstats <- read.csv(\"NHLdraftstats.csv\")\n\nlibrary(dplyr)\n\nplayers_stats_2013_2 <- NHLdraftstats %>%\n  filter(draftyear == 2013) %>%\n  filter(name != \"Elias Lindholm\")\n\nggplot(players_stats_2013_2, aes(x=postdraft, y=NHLgames, color=as.factor(round))) +\n  geom_smooth(se=FALSE) +\n  theme_minimal() +\n  ggtitle(\"Overall Players in 2013 by Draft Round\") +\n  xlab(\"Post Draft Position\") +  \n  ylab(\"NHL Games Played\") + \n  theme(plot.title = element_text(hjust = 0.5)) +\n  scale_color_brewer(palette=\"Set1\", name=\"Draft Round\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`geom_smooth()` using method = 'loess' and formula = 'y ~ x'\n```\n:::\n\n::: {.cell-output-display}\n![](Asig5_2_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\n**Figure 1:** Representation of the overall players that were drafted in 2013. By looking at this line graph we can determine that the players drafted in Round 1 played the most NHL games compared from the other draft rounds. This indicates that players selected in the first round draft, are valuable players that can bring a lot winnings to the team. The NHL player Elias Lindholm was drafted in this year 2013 in the first round pick. \n\n\n### Elias Lindholm Performance\n\nSince, we looked at the overall pick of players that were drafted in 2013, I wanted to look were Elias Lindholm performance lies post draft.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(dplyr)\nlibrary(ggplot2)\n\nNHLdraftstats <- read.csv(\"NHLdraftstats.csv\")\n\n\nElias_stats <- NHLdraftstats %>%\n  filter(name == \"Elias Lindholm\")\n\nggplot(Elias_stats, aes(x=postdraft, y=NHLgames)) +\n  geom_smooth() +  \n  theme_minimal() +\n  ggtitle(\"Elias Lindholm Performance\") +\n  xlab(\"Post Draft Position\") +  \n  ylab(\"NHL Games Played\") + \n  theme(plot.title = element_text(hjust = 0.5))\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`geom_smooth()` using method = 'loess' and formula = 'y ~ x'\n```\n:::\n\n::: {.cell-output-display}\n![](Asig5_2_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\n**Figure 2:** This line graph represent Elias Lindholm post draft, and we can see that at the beginning of being drafted has played a lot of NHL games, meaning that he is an outstanding player.\n\n\n### 2013 Draft Pick by Positions\n\nElias Lindholm is in the forward position, I wanted to see how many players got drafted from the same position in contrast to the other positions.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplayers_stats_2013 <- NHLdraftstats %>%\n  filter(draftyear == 2013)\n\nlibrary(dplyr)\n\n\nagg_data <- players_stats_2013 %>%\n  group_by(round, position) %>%\n  summarise(AvgNHLGames = mean(NHLgames, na.rm = TRUE), .groups = 'drop')\n\n\nggplot(agg_data, aes(x = factor(round), y = AvgNHLGames, fill = factor(round))) +\n  geom_col() +\n  facet_wrap(~position, scales = \"free_y\") +\n  theme_minimal() +\n  ggtitle(\"Average NHL Games Played by Draft Round and Position (2013)\") +\n  xlab(\"Draft Round\") +\n  ylab(\"Average NHL Games Played\") +\n  scale_fill_brewer(palette = \"Set1\", name = \"Draft Round\") +\n  theme(plot.title = element_text(hjust = 0.5),\n        axis.text.x = element_text(angle = 45, hjust = 1, size = 12))\n```\n\n::: {.cell-output-display}\n![](Asig5_2_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\n**Figure3:** The following bar graphs are divided by position, by round and the average of NHL played games from the players that were drafted in 2013. By looking at this graphs we can say that the positions for forward and defense are highly drafted in the first round and are the ones that played the most in NHL games. The Goal Tender there's no overall pick in this 2013 draft pick. Meaning that these two positions for defense and forward are the most highly looked for selecting players.\n\n\n### Elias Lindholm vs Drafted Players 2013 Performance\n\nWe now that Elias Lindholm has a good performance after being drafted. I wanted to compare with the other players that were also drafted on 2013. This will help me have a perspective why Calgary did the trade with Vancouver for him. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nplayers_stats_2013 <- NHLdraftstats %>%\n  filter(draftyear == 2013)\n\nlibrary(dplyr)\nlibrary(ggplot2)\n\n# Calculate the average NHL games played by players other than Elias Lindholm\naverage_games <- players_stats_2013 %>%\n  filter(name != \"Elias Lindholm\") %>%\n  summarise(average_NHL_games = mean(NHLgames, na.rm = TRUE))\n\n# Calculate Elias Lindholm's average NHL games\nelias_avg_games <- players_stats_2013 %>%\n  filter(name == \"Elias Lindholm\") %>%\n  summarise(NHLgames = mean(NHLgames, na.rm = TRUE)) %>%\n  mutate(name = \"Elias Lindholm\", category = \"Individual\")\n\n# Create a data frame for the draft average\naverage_df <- data.frame(\n  name = \"2013 Draft Average\",\n  NHLgames = average_games$average_NHL_games,\n  category = \"Average\"\n)\n\n# Ensure both data frames have the same structure and combine them\ncomparison_data <- rbind(elias_avg_games, average_df)\n\n# Create the bar graph comparing Elias Lindholm's NHL games played to the 2013 draft average\nggplot(comparison_data, aes(x = name, y = NHLgames, fill = category)) +\n  geom_col() +\n  theme_minimal() +\n  ggtitle(\"Elias Lindholm vs. 2013 Draft Average NHL Games Played\") +\n  xlab(\"Category\") +\n  ylab(\"NHL Games Played\") +\n  scale_fill_manual(values = c(\"Average\" = \"red\", \"Individual\" = \"blue\")) +\n  theme(plot.title = element_text(hjust = 0.5), axis.text.x = element_blank())\n```\n\n::: {.cell-output-display}\n![](Asig5_2_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n**Figure 4:** In this bar graph is comparison between the performance of Elias Lindholm vs the drafted players of 2013. I took the average of the NHL games played of the drafted players (is the one label as average and the blue bar) and also the average for Elias's performance (is the one label as individual and the red bar). By looking at this graph we can say that Elias's performance is alot higher than the overall average of the players that were drafted at the same year as Elias.\n\n\n### Elias Lindholm vs Forward Players (Drafted in 2013)\n\nWe now that Elias Lindholm has a good performance after being drafted compared to other players that were drafted on the same year. Now, I wanted to compare the performance with players that have the same position as Elias. This also, will give more insight the decision of the trade. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nforwards_2013 <- players_stats_2013 %>%\n  filter(draftyear == 2013, position == \"Forward\") %>%\n  select(name, position, NHLgames) \n\nlibrary(dplyr)\n\n# Mark Elias Lindholm and other players\nplayers_stats_2013 <- players_stats_2013 %>%\n  mutate(Category = ifelse(name == \"Elias Lindholm\", \"Elias Lindholm\", \"Other Players\"))\n\n# Calculate average NHL games for Elias and other players\navg_games_comparison <- players_stats_2013 %>%\n  group_by(Category) %>%\n  summarise(AverageNHLGames = mean(NHLgames, na.rm = TRUE))\n\n# Plot\nggplot(avg_games_comparison, aes(x = Category, y = AverageNHLGames, fill = Category)) +\n  geom_col() +\n  theme_minimal() +\n  ggtitle(\"Average NHL Games: Elias Lindholm vs Other Forwards (2013 Draft)\") +\n  xlab(\"\") +\n  ylab(\"Average NHL Games Played\") +\n  scale_fill_manual(values = c(\"Elias Lindholm\" = \"blue\", \"Other Players\" = \"red\"))\n```\n\n::: {.cell-output-display}\n![](Asig5_2_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\n**Figure 4:** In this bar graph is comparison between the performance of Elias Lindholm vs the players on the same position as forward. I took the average of the NHL games played of the drafted players (is the one label as Other Players) and also the average for Elias's performance (Blue bar). By looking at this graph we can say that Elias's performance is alot higher than the overall average of the players that were drafted at the same year as Elias in the postion as forward.\n\n\n### Elias Lindholm vs. Forwards (Drafted in 2018)\n\nWe now that Elias Lindholm has a good performance, now I wanted to compare its performance with forward players that were drafted in 2018. It is clear that Elias has more experience and has alot of exposure in playing alot of NHL games. I just wanted to see and compare their performances between the two variables. Like having an experience player is better than acquiring new players. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(dplyr)\n\nplayers_stats_2018 <- NHLdraftstats %>%\n  filter(draftyear == 2018, position == \"Forward\") %>%\n  select(name, position, NHLgames) \n\nlibrary(dplyr)\nlibrary(ggplot2)\n\n# Assuming Elias Lindholm is also a forward and you want his stats\nelias_metric <- NHLdraftstats %>%\n  filter(name == \"Elias Lindholm\", position == \"Forward\") %>%\n  summarise(AverageNHLGames = mean(NHLgames, na.rm = TRUE))\n\n# Calculate the average NHL games for forwards drafted in 2018\navg_2018_metric <- players_stats_2018 %>%\n  filter(position == \"Forward\") %>%\n  summarise(AverageNHLGames = mean(NHLgames, na.rm = TRUE))\n\n# Combine the data for comparison\ncomparison_data <- rbind(\n  data.frame(Name = \"Elias Lindholm\", Metric = elias_metric$AverageNHLGames),\n  data.frame(Name = \"2018 Forwards\", Metric = avg_2018_metric$AverageNHLGames)\n)\n\n# Plot the comparison\nggplot(comparison_data, aes(x = Name, y = Metric, fill = Name)) +\n  geom_col() +\n  theme_minimal() +\n  ggtitle(\"Comparison: Elias Lindholm vs. 2018 Forwards\") +\n  ylab(\"Average NHL Games Played\") +\n  xlab(\"\") +\n  scale_fill_manual(values = c(\"Elias Lindholm\" = \"blue\", \"2018 Forwards\" = \"red\"))\n```\n\n::: {.cell-output-display}\n![](Asig5_2_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\n**Figure 5:** \n\n**Figure 4:** In this bar graph is comparison between the performance of Elias Lindholm vs the players on the same position as forward. I took the average of the NHL games played of the drafted players (is the one label as Other Players) and also the average for Elias's performance (Blue bar). By looking at this graph we can say that Elias's performance is alot higher than the overall average of the players that were drafted at the same year as Elias in the postion as forward.\n\n\n## CONCLUSION\n\nBased on my visualizations, I think the Vancouver Canucks got a good trade with Elias Lindholm. He's a solid forward based on the comparison data of other players in the same position in the same draft year; Elias Lindholm is a player in another league. Maybe, the reason that the Canucks made the trade with the Calgary Flames; is that they needed a player that could bring them the win of the Stanley Cup. The Canucks are thinking about their current gaming plan; and not too much about the future. Maybe the Calgary Flames wanted new players to improve their gaming strategies, and have a solid team for the future NHL games.\n\n\n\n\n",
    "supporting": [
      "Asig5_2_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}